<h1>Plugins</h2>
<div id="generated-toc"> </div>

<p>If you made a plugin and want it included in this directory, let me know!</p>

<h2>Generic</h2>

<h3>Conditional HTML insertion</h3>
<p>This plugin inserts an HTML snippet into the page iff that page has an element matching certain selector.</p>
<p>
The key difference from the built-in <code>insert_html</code> widget is that it can check for one element,
but insert in another. The element to check for is defined by the <code>check_selector</code> option,
while the <code>selector</code> option defines the target element to insert the snippet in.
</p>
<p>
For example, if some content requires some JavaScript to interpret, you may want to insert that JavaScript only in pages
that actually need it. Of course, that JS usually has to go to the page <code>&lt;head&gt;</code>,
not inside the content element, and you don't need it in <em>every</em> element, so <code>insert_html</code>
doesn't work well for this task.
</p>
<p>
One example is self-hosted <a href="https://asciinema.org">asciinema</a> player. It's smaller than a video
would be, but it's still quite a chunk of JS and it's better to insert it only in pages that have any <code>&lt;asciinema-player&gt;</code>
elements.
</p>
<p>
There are other possible uses of course. Here's an example that adds a warning to your page if it has any <code>&lt;blink&gt;</code>
elements:
</p>
<pre>
[plugins.insert_if]
  file = "plugins/insert-if.lua"

[widgets.blink-warning]
  widget = "insert_if"
  html = "&lt;div&gt;&lt;strong&gt;Warning: blink elements are obsolete!&lt;/strong&gt;&lt;/div&gt;"
  selector = "body"
  check_selector = "blink"
</pre>

<p>Download: <a href="/files/plugins/insert-if.lua">insert-if.lua</a>.</p>

<h3>File inclusion</h3>
<p>
For those who miss <code>{% include "path/to/file" %}</code> directives from template processors.
</p>
<p>
This plugin adds a fake HTML element <code>&lt;include&gt;path/to/file&lt;/include&gt;</code>.
For example:
</p>
<pre>&lt;include&gt; includes/footer.html &lt;/include&gt;</pre>
<p>
When it encounters this element, it reads the <code>includes/footer.html</code> file and replaces the include element with its content.
</p>
<p>
By default the file is parsed as HTML, but you can also include it as raw text with HTML special
characters escaped, using <code>&lt;include raw="raw"&gt;...&lt;/include&gt;</code>.
</p>
<p>
You can specify either an absolute or a relative path. If a relative path is given,
it's relative to the current directory where you run soupault.
</p>

<p>Sample configuration:</p>
<pre>
[plugins.include-tag]
  file = "plugins/include.lua"

[widgets.process-include-tags]
  widget = "include-tag"
</pre>

<p>Download: <a href="/files/plugins/include.lua">include.lua</a>.</p>

<h2>Content</h2>

<h3>Reading time</h3>
<p>
Calculates estimated reading time based on word count and inserts it into the page. Sample configuration
that counts words inside a <code>&lt;div id="content"&gt;</code> and inserts the result in <code>&lt;span id="reading-time"&gt;</code>:
</p>
<pre>
[plugins.reading-time]
  file = "plugins/reading-time.lua"

[widgets.insert-reading-time]
  widget = "reading-time"
  selector = "span#reading-time"
  content_selector = "div#content"
</pre>
<p>Download: <a href="/files/plugins/reading-time.lua">reading-time.lua</a>.</p>

<h3>Escape HTML special characters</h3>
<p>
Writing <em>about</em> HTML in HTML can be especially annoying since you have to replace all special characters (&lt;, &gt;, &amp;) with
HTML entities. I always wished the <code>&lt;pre&gt;</code> tag content was treated as raw data, since we sadly gave up on XHTML anyway.
With this plugin you can do it easily.
</p>
<p>
It converts the content of an element to its HTML source. E.g. <code>&lt;pre&gt;&lt;p&gt;hello world&lt;/p&gt;&lt;/pre&gt;</code>
to <code>&lt;pre&gt;&amp;lt;p&amp;gt;hello world&amp;lt;/p&amp;gt;&lt;/pre&gt;</code>.
</p>
<pre>
[plugins.escape_html]
  file = "plugins/escape-html.lua"

[widgets.raw-html-in-pre]
  widget = "escape_html"
  selector = "pre"
</pre>
<p>Download: <a href="/files/plugins/escape-html.lua">escape-html.lua</a>.</p>

<h2>Navigation</h2>
<h3>Site URL</h3>
<p>
This plugin changes all relative links like <code>/about.html</code> to absolute like <code>https://www.example.com/about.html</code>.
Sample configuration:
</p>
<pre>
[plugins.site-url]
  file = "plugins/site-url.lua"

[widgets.set-site-url]
  widget = "site-url"
  site_url = "https://www.example.com"  
</pre>
<p>Download: <a href="/files/plugins/site-url.lua">site-url.lua</a>.</p>

<h3>Active link highlight</h3>
<p>
This plugin highlights the link to the current page/section in a navigation menu. You can see that the &ldquo;Plugins&rdquo; link
on this page is bold, it's what this plugin does (it adds a <code>nav-active</code> class to that link).
</p>
<p>
It assumes that you are using relative links and that you keep all navigation links inside one element (like <code>&lt;nav&gt;</code>).
It may require some tweaking for your website. Sample configuration:
</p>
<pre>
[plugins.section-link-highlight]
  file = "plugins/section-link-highlight.lua"

[widgets.nav-menu]
  widget = "include"
  file = "templates/menu.html"
  selector = "div#nav-menu"

[widgets.highlight-active-link]
  after = "nav-menu"
  widget = "section-link-highlight"
  selector = "div#nav-menu"
  active_link_class = "nav-active"
</pre>
<p>
If you keep navigation menu in a separate file like I do, the <code>after = </code> option is necessary for correct ordering,
otherwise the <code>highlight-active-link</code> widget may run before navigation links are actually available.
</p>
<p>Download: <a href="/files/plugins/section-link-highlight.lua">section-link-highlight.lua</a>.</p>

<h3>Page source link</h3>
<p>
For people who store their site source in a public repository. This plugin inserts a link to the page source file
in the repository, by appending the page file path to a base URL (the <code>repo_base</code> option).
</p>
<p>Written by <a href="https://hristos.lol/">Hristos N. Triantafillou</a>.</p>
<p>Sample configuration from his site:</p>
<pre>
[plugins.source-link]
  file = "plugins/source-link.lua"

[widgets.source-link]
  widget = "source-link"
  selector = "div#source-link"
  link_text = "Source link for this page"
  repo_base = "https://git.sr.ht/~hristoast/hristoast/tree/master/"
</pre>

<p>Download: <a href="/files/plugins/source-link.lua">source-link.lua</a>.</p>
